# 产品需求文档（PRD）

## 1. 产品概述

### 1.1 产品定位
发票管理系统是一个面向中小企业和个人用户的智能发票处理平台，通过自动化技术解决发票收集、识别、存储和管理的痛点。

### 1.2 目标用户
- **主要用户**：财务人员、个体工商户、自由职业者
- **次要用户**：中小企业管理者、报销申请人

### 1.3 核心价值
1. **自动化收集**：自动从邮箱下载发票附件，减少手工操作
2. **智能识别**：AI 技术精准提取发票信息，提高处理效率
3. **集中管理**：统一平台管理所有发票，便于查询和统计
4. **数据安全**：本地化部署，确保发票数据安全

## 2. 功能需求

### 2.1 用户管理
#### 2.1.1 注册登录
- 邮箱注册/登录
- 密码找回
- 个人信息管理

#### 2.1.2 权限管理
- 普通用户：管理个人发票
- 管理员：系统配置和用户管理

### 2.2 邮箱管理
#### 2.2.1 邮箱配置
- 支持主流邮箱（QQ、163、126、Gmail、Outlook）
- IMAP/SMTP 协议配置
- 授权码管理

#### 2.2.2 自动同步
- 定时检查新邮件
- 筛选包含"发票"关键词的邮件
- 自动下载 PDF 附件

### 2.3 发票处理
#### 2.3.1 发票识别
- 增值税普通发票
- 增值税专用发票
- 火车票
- 机票行程单
- 出租车票
- 定额发票

#### 2.3.2 信息提取
- 发票代码/号码
- 开票日期
- 销售方信息（名称、税号）
- 购买方信息（名称、税号）
- 金额（不含税、税额、价税合计）
- 项目明细

#### 2.3.3 手动上传
- 支持 PDF、JPG、PNG 格式
- 批量上传
- 拖拽上传

### 2.4 发票管理
#### 2.4.1 查询筛选
- 按日期范围查询
- 按销售方查询
- 按金额范围查询
- 按发票类型查询
- 全文搜索

#### 2.4.2 数据编辑
- 修改识别错误的信息
- 添加备注和标签
- 关联报销单据

#### 2.4.3 批量操作
- 批量下载
- 批量导出 Excel
- 批量删除
- 批量归档

### 2.5 统计分析
#### 2.5.1 数据统计
- 发票总数和总金额
- 按月度/季度/年度统计
- 按类别统计
- 按供应商统计

#### 2.5.2 报表生成
- 发票明细表
- 汇总报表
- 税务申报表
- 自定义报表

### 2.6 系统设置
#### 2.6.1 OCR 服务配置
- 阿里云 OCR 配置
- MinERU API 配置
- 识别精度设置

#### 2.6.2 存储管理
- 本地存储路径配置
- 云存储配置（可选）
- 自动清理策略

## 3. 非功能需求

### 3.1 性能要求
- 单张发票识别时间 < 3秒
- 支持并发处理 10 张发票
- 页面响应时间 < 1秒
- 支持 10000+ 发票存储

### 3.2 安全要求
- HTTPS 加密传输
- 用户密码加密存储
- 邮箱授权码加密
- 操作日志审计

### 3.3 可用性要求
- 简洁直观的界面设计
- 支持移动端适配
- 错误提示友好
- 操作引导完善

### 3.4 兼容性要求
- 浏览器：Chrome、Firefox、Safari、Edge
- 操作系统：Windows、macOS、Linux
- 部署环境：Docker、云服务器

## 4. 产品路线图

### Phase 1: MVP 版本（已完成）
- [x] 用户注册登录
- [x] 邮箱配置和发票下载
- [x] 基础 OCR 识别
- [x] 发票查询和管理

### Phase 2: 功能增强（当前版本）
- [x] Supabase 集成
- [x] 高精度 OCR（MinERU）
- [x] 批量处理优化
- [x] 前后端分离架构

### Phase 3: 企业版本（计划中）
- [ ] 多用户协作
- [ ] 审批流程
- [ ] API 开放平台
- [ ] 移动 APP

### Phase 4: AI 增强（未来）
- [ ] 智能分类
- [ ] 异常检测
- [ ] 自动报销匹配
- [ ] 预测分析

## 5. 竞品分析

### 5.1 主要竞品
1. **费控系统**：SAP Concur、金蝶云
2. **发票管理**：票总管、发票通
3. **OCR 服务**：百度 OCR、腾讯 OCR

### 5.2 竞争优势
1. **开源免费**：降低使用成本
2. **本地部署**：数据安全可控
3. **定制灵活**：满足个性化需求
4. **技术先进**：采用最新技术栈

## 6. 成功指标

### 6.1 用户指标
- 月活跃用户数 > 1000
- 用户留存率 > 60%
- 用户满意度 > 4.5/5

### 6.2 业务指标
- 发票识别准确率 > 95%
- 处理效率提升 > 80%
- 系统稳定性 > 99.9%

## 7. 风险和挑战

### 7.1 技术风险
- OCR 识别准确率依赖第三方服务
- 大批量处理的性能瓶颈
- 不同发票格式的兼容性

### 7.2 市场风险
- 电子发票的普及影响
- 税务政策的变化
- 竞品的价格战

### 7.3 应对策略
- 支持多个 OCR 服务切换
- 采用分布式架构提升性能
- 持续跟进政策和市场变化