# 发票详情卡片式布局更新

## 更新日期
2025-07-12

## 设计理念

根据火车票和增值税发票的不同数据结构，设计了合理的分组卡片展示方式，提供更清晰、更直观的信息展示。

## 主要改进

### 1. 新增 InvoiceDetailCards 组件

创建了 `components/invoice/details/InvoiceDetailCards.tsx`，实现了针对不同发票类型的专属展示：

#### 火车票详情卡片
- **行程信息卡片**：出发站、到达站、出发时间、车次、座位类型、座位号
- **乘客信息卡片**：乘客姓名、身份信息
- **票据信息卡片**：电子客票号、票号、开票日期、票价
- **购买方信息卡片**：购买方名称、统一社会信用代码
- **其他信息卡片**：备注、是否复印件

#### 增值税发票详情卡片
- **发票信息卡片**：发票号码、发票类型、开票日期、校验码
- **金额信息卡片**：价税合计、不含税金额、税额、价税合计（大写）
- **购销双方信息卡片**：购买方和销售方的名称、纳税人识别号、地址电话
- **商品明细卡片**：表格形式展示商品详情（名称、规格、单位、数量、单价、金额、税率、税额）
- **其他信息卡片**：开票人、审核人、收款人、备注、是否复印件

### 2. 视觉设计特点

- **卡片式布局**：每个信息组使用独立卡片，界面更清晰
- **图标增强**：每个信息项配有相应的 Lucide 图标，提升可读性
- **响应式设计**：使用 `grid-cols-1 md:grid-cols-2` 适配不同屏幕
- **颜色编码**：
  - 金额使用 `text-success` 绿色
  - 是否复印件使用 `CheckCircle`（绿色）或 `XCircle`（黄色）图标
  - 重要信息使用 `text-primary` 主题色

### 3. 数据处理

- **智能字段映射**：兼容 `extracted_data` 中的 OCR 数据和发票模型的基础字段
- **空值处理**：所有字段都有默认值 `'-'`，避免显示 undefined
- **类型判断**：
  ```typescript
  const isTrainTicket = invoice.invoice_type === '火车票' || 
    invoice.extracted_data?.title?.includes('铁路电子客票');
  
  const isVATInvoice = invoice.invoice_type === '增值税发票' || 
    invoice.extracted_data?.invoiceType?.includes('数电');
  ```

### 4. InvoiceDetailModal 优化

- **简化结构**：移除了原有的表单式布局，完全使用卡片组件
- **改进滚动**：添加了内容区域的滚动支持，适配移动端
- **增大模态框**：`max-w-4xl` 提供更宽的展示空间
- **高度自适应**：移动端 `h-[90vh]`，桌面端 `h-auto`

## 使用效果

1. **信息层次清晰**：相关信息分组展示，便于快速查找
2. **视觉体验提升**：卡片式设计更现代，图标增强可读性
3. **响应式适配**：移动端和桌面端都有良好体验
4. **扩展性强**：易于添加新的发票类型支持

## 技术实现

- 使用 React 函数组件和 TypeScript
- 基于 DaisyUI 的卡片组件（`card`、`card-body`、`card-title`）
- Lucide React 图标库
- Tailwind CSS 实用类

## 后续优化建议

1. 可以添加数据复制功能（点击复制发票号码等）
2. 可以实现卡片的折叠/展开功能
3. 可以添加更多发票类型的支持（如出租车发票、餐饮发票等）
4. 可以实现数据导出功能（导出为 PDF 或 Excel）